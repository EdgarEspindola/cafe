<div class="row">
    <div class='col-sm-12'>
        <h1 class='title-md hr text-center text-uppercase'>
          <%= t('.title') %>
        </h1>
    </div>
</div>

<div class="row">
    <div class='col-sm-12'>
      <div class="pull-right">
          <%= link_to new_entrada_path, class: "btn btn-ghost btn-primary", style: "margin-left: 10px;" do %>   
            <i class="fa fa-plus-square"  aria-hidden="true"></i>
            <%= t('.new_entrada_link') %>
          <% end %>
          
          <button type="button" class="btn btn-success" data-toggle="modal" data-target="#exportarExcelModal">
            <i class="fa fa-file-excel-o" aria-hidden="true"></i>
            Exportar
          </button>
      </div>         
    </div>
</div>

<!-- Modal para Exportar Excel -->
<div class="modal fade" id="exportarExcelModal" tabindex="-1" role="dialog" aria-labelledby="exportarExcelModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header" style="background-color: #5cb85c; color: white;">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: white; opacity: 0.8;">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title" id="exportarExcelModalLabel">
          <i class="fa fa-file-excel-o" aria-hidden="true"></i>
          Exportar Entradas a Excel
        </h4>
      </div>
      
      <%= form_tag excel_export_entradas_path, method: :get, id: 'excel_export_form' do %>
        <div class="modal-body">
          <p class="text-muted">
            <i class="fa fa-info-circle"></i>
            Seleccione el rango de fechas para exportar las entradas registradas
          </p>
          
          <div class="row">
            <div class="col-sm-6">
              <div class="form-group">
                <label for="fecha_inicio" class="control-label"><strong>Fecha Inicio</strong></label>
                <div class="input-group datetimepicker_export_range">
                  <span class="input-group-addon">
                    <i class="glyphicon glyphicon-calendar text-success"></i>
                  </span>
                  <%= text_field_tag :fecha_inicio, (Date.today - 30.days).strftime('%d/%m/%Y'), 
                      class: 'form-control', readonly: true, required: true, 
                      style: 'cursor: pointer;' %>
                </div>
              </div>
            </div>
            
            <div class="col-sm-6">
              <div class="form-group">
                <label for="fecha_fin" class="control-label"><strong>Fecha Fin</strong></label>
                <div class="input-group datetimepicker_export_range">
                  <span class="input-group-addon">
                    <i class="glyphicon glyphicon-calendar text-success"></i>
                  </span>
                  <%= text_field_tag :fecha_fin, Date.today.strftime('%d/%m/%Y'), 
                      class: 'form-control', readonly: true, required: true, 
                      style: 'cursor: pointer;' %>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">
            <i class="fa fa-times" aria-hidden="true"></i>
            Cancelar
          </button>
          <%= button_tag type: :submit, class: 'btn btn-success' do %>
            <i class="fa fa-download" aria-hidden="true"></i>
            Descargar Excel
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<% if @entradas.blank? %>
    <p class='lead'>Aún no tienes entradas registradas.</p>    
<% else %>        
    <div class="table-responsive">
      <table class="table table-striped table-hover table-condensed">
        <thead>
          <tr scope="row">
            <th><%= t('.entradas.numero_entrada') %></th>
            <th><%= t('.entradas.date') %></th>
            <th><%= t('.entradas.organization') %></th>
            <th><%= t('.entradas.total_partidas') %></th>          
            <th><%= t('.entradas.updated_at') %></th>
          
            <th colspan="3"><%= t('.entradas.options') %></th>
          </tr>
        </thead>
        <tbody>
          <% @entradas.each_with_index do |entrada, index| %>
          <tr>
            <td><%= padded_zeros_numero_entrada(entrada.numero_entrada) %></td>
            <td><%= l entrada.date, format: :medium_date %></td>
            <td><%= entrada.client.organization %></td>
            <td><%= entrada.partidas.size %></td>            
            <td><%= l entrada.updated_at, format: :medium %></td>
            <td>
                <%= link_to entrada do %>
                  <i class="fa fa-eye" aria-hidden="true"></i>                    
                <% end %>
              </td>
              <% unless entrada.tiene_partidas_con_salidas %>
              <td>
                <%= link_to edit_entrada_path(entrada) do %>
                  <i class="fa fa-pencil" aria-hidden="true"></i>                    
                <% end %>              
              </td>  
              <td>
                <%= link_to entrada, method: :delete, data: { confirm: '¿Está usted seguro?' } do %>
                  <i class="fa fa-remove" aria-hidden="true"></i>                                      
                <% end %>
              </td>        
              <% end %>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="row">
        <div class="col-sm-12 text-center">
          <%= paginate @entradas %>          
        </div>        
    </div>
<% end %>